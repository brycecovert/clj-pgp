<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>clj-pgp.message documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clj-pgp</span> <span class="project-version">0.10.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clj-pgp</span></div></div></li><li class="depth-2 branch"><a href="clj-pgp.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="clj-pgp.generate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>generate</span></div></a></li><li class="depth-2 branch"><a href="clj-pgp.keyring.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>keyring</span></div></a></li><li class="depth-2 branch current"><a href="clj-pgp.message.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>message</span></div></a></li><li class="depth-2 branch"><a href="clj-pgp.signature.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>signature</span></div></a></li><li class="depth-2 branch"><a href="clj-pgp.tags.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tags</span></div></a></li><li class="depth-2"><a href="clj-pgp.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="clj-pgp.message.html#var-armored-data-stream"><div class="inner"><span>armored-data-stream</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-compressed-data-stream"><div class="inner"><span>compressed-data-stream</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-data-formats"><div class="inner"><span>data-formats</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-decrypt"><div class="inner"><span>decrypt</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-encrypt"><div class="inner"><span>encrypt</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-encrypted-data-stream"><div class="inner"><span>encrypted-data-stream</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-literal-data-stream"><div class="inner"><span>literal-data-stream</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-message-output-stream"><div class="inner"><span>message-output-stream</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-package"><div class="inner"><span>package</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-read-messages"><div class="inner"><span>read-messages</span></div></a></li><li class="depth-1"><a href="clj-pgp.message.html#var-reduce-messages"><div class="inner"><span>reduce-messages</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">clj-pgp.message</h1><div class="doc"><div class="markdown"><p>The functions in this namespace package raw data into PGP <em>messages</em>, which can be compressed, encrypted, and signed.</p>
<p>The encryption functions use the concept of <em>encryptors</em> and <em>decryptors</em>. A collection of encryptors may be used to encipher a message, and any corresponding decryptor will be able to decipher it.</p>
<p>For symmetric encryption, the encryptor is the passphrase string and the corresponding decryptor is the same string.</p>
<p>For public-key encryption, the encryptor is the public-key object and the decryptor is the corresponding private-key. Alternately, the decryptor can be a function which accepts a key id and returns the corresponding private-key, to look it up or unlock the key on demand.</p></div></div><div class="public anchor" id="var-armored-data-stream"><h3>armored-data-stream</h3><div class="usage"><code>(armored-data-stream output)</code></div><div class="doc"><div class="markdown"><p>Wraps an <code>OutputStream</code> with an armored data stream. Packets written to this stream will be output in ASCII encoded Base64.</p></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-compressed-data-stream"><h3>compressed-data-stream</h3><div class="usage"><code>(compressed-data-stream output algorithm)</code></div><div class="doc"><div class="markdown"><p>Wraps an <code>OutputStream</code> with a compressed data generator, returning another stream. Typically, literal data packets will be written to this stream, which are compressed and written to an underlying encryption stream.</p></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-data-formats"><h3>data-formats</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Supported data formats which can be specified when building literal data packets.</p></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-decrypt"><h3>decrypt</h3><div class="usage"><code>(decrypt input decryptor &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Decrypts a message packet and attempts to decipher it with the given decryptor. Returns the data of the first message directly.</p>
<p>See <code>read-messages</code> for options.</p></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-encrypt"><h3>encrypt</h3><div class="usage"><code>(encrypt data encryptors &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Constructs a message packet enciphered for the given encryptors. See <code>message-output-stream</code> for options.</p></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-encrypted-data-stream"><h3>encrypted-data-stream</h3><div class="usage"><code>(encrypted-data-stream output cipher encryptors &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Wraps an <code>OutputStream</code> with an encrypted data generator, returning another stream. The data written to the stream will be encrypted with a symmetric session key, which is then encrypted for each of the given public keys.</p>
<p>Typically, the data written to this will consist of compressed data packets. If the data is longer than the buffer size, the packet is written in chunks in a streaming fashion.</p>
<p>Options may be provided to customize the packet:</p>
<ul>
  <li><code>:buffer-size</code> maximum number of bytes per chunk</li>
  <li><code>:integrity-packet</code> whether to include a Modification Detection Code packet</li>
  <li><code>:random</code> custom random number generator</li>
</ul></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-literal-data-stream"><h3>literal-data-stream</h3><div class="usage"><code>(literal-data-stream output &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Wraps an <code>OutputStream</code> with a literal data generator, returning another stream. Typically, the wrapped stream is a compressed data stream or encrypted data stream.</p>
<p>Data written to the returned stream will write a literal data packet to the wrapped output stream. If the data is longer than the buffer size, the packet is written in chunks in a streaming fashion.</p>
<p>Options may be provided to customize the packet:</p>
<ul>
  <li><code>:buffer-size</code> maximum number of bytes per chunk</li>
  <li><code>:format</code> data format type</li>
  <li><code>:filename</code> filename string for the data</li>
  <li><code>:mtime</code> data modification time</li>
</ul></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-message-output-stream"><h3>message-output-stream</h3><div class="usage"><code>(message-output-stream output &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Wraps the given output stream with compression and encryption layers. The data will decryptable by the corresponding decryptors. Does <em>not</em> close the wrapped stream when it is closed.</p>
<p>Opts may contain:</p>
<ul>
  <li><code>:buffer-size</code> maximum number of bytes per chunk</li>
  <li><code>:compress</code> compress the cleartext with the given algorithm, if specified</li>
  <li><code>:cipher</code> symmetric key algorithm to use if encryptors are provided</li>
  <li><code>:encryptors</code> keys to encrypt the cipher session key with</li>
  <li><code>:armor</code> whether to ascii-encode the output</li>
</ul>
<p>See <code>literal-data-stream</code> and <code>encrypted-data-stream</code> for more options.</p></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-package"><h3>package</h3><div class="usage"><code>(package data &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Compresses, encrypts, and encodes the given data and returns an encoded message packet. If the <code>:armor</code> option is set, the result will be an ASCII string; otherwise, the function returns a byte array.</p>
<p>The message will readable by any of the corresponding decryptors.</p>
<p>See <code>message-output-stream</code> for options.</p></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-read-messages"><h3>read-messages</h3><div class="usage"><code>(read-messages input &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Reads message packets from an input source and returns a sequence of message maps which have realized <code>:data</code> entries.</p>
<p>See <code>reduce-messages</code> for options</p></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div><div class="public anchor" id="var-reduce-messages"><h3>reduce-messages</h3><div class="usage"><code>(reduce-messages input rf acc &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Reads message packets form an input source and reduces over them with the given accumulator <code>acc</code> and reducing function <code>rf</code>. Each message contains keys similiar to the options used to build them, describing the type of compression used, cophier encrypted with, etc. The <code>rf</code> should take the accumulator and a <code>message</code> and return the resulting accumulator. It must consume the stream passed in the <code>:data</code> field. A message is a map containing: - <code>:format</code> one of #{:binary :text :utf8} - <code>:data</code> An InputStream - <code>:filename</code> the name of the file - <code>:mtime</code> the modified time of the message</p>
<p>Opts may contain:</p>
<ul>
  <li><code>:decryptor</code> secret to decipher the message encryption</li>
</ul></div></div><div class="src-link"><a href="https://github.com/greglook/clj-pgp/blob/master/">view source</a></div></div></div></body></html>